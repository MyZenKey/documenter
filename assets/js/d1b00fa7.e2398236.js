"use strict";(self.webpackChunkdevpub=self.webpackChunkdevpub||[]).push([[4383],{3905:function(e,t,r){r.d(t,{Zo:function(){return l},kt:function(){return h}});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var c=n.createContext({}),p=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},l=function(e){var t=p(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(r),h=i,y=d["".concat(c,".").concat(h)]||d[h]||u[h]||o;return r?n.createElement(y,a(a({ref:t},l),{},{components:r})):n.createElement(y,a({ref:t},l))}));function h(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=r[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},1093:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return l},default:function(){return d}});var n=r(7462),i=r(3366),o=(r(7294),r(3905)),a=["components"],s={title:"Test Your App",slug:"integrating-apps-test-your-app",hidden:!1,createdAt:"2020-05-08T20:43:09.024Z",updatedAt:"2021-07-08T16:43:52.442Z"},c=void 0,p={unversionedId:"best-practices/best-practices-integrating-apps/integrating-apps-test-your-app",id:"best-practices/best-practices-integrating-apps/integrating-apps-test-your-app",isDocsHomePage:!1,title:"Test Your App",description:"After integrating ZenKey with your service, test whether your app can successfully:",source:"@site/docs/best-practices/best-practices-integrating-apps/integrating-apps-test-your-app.md",sourceDirName:"best-practices/best-practices-integrating-apps",slug:"/best-practices/best-practices-integrating-apps/integrating-apps-test-your-app",permalink:"/documenter/docs/best-practices/best-practices-integrating-apps/integrating-apps-test-your-app",editUrl:"https://github.com/MyZenKey/documenter/edit/main/docs/best-practices/best-practices-integrating-apps/integrating-apps-test-your-app.md",tags:[],version:"current",frontMatter:{title:"Test Your App",slug:"integrating-apps-test-your-app",hidden:!1,createdAt:"2020-05-08T20:43:09.024Z",updatedAt:"2021-07-08T16:43:52.442Z"},sidebar:"tutorialSidebar",previous:{title:"Carrier Apps",permalink:"/documenter/docs/best-practices/best-practices-integrating-apps/integrating-apps-carrier-apps"},next:{title:"Trusted Browsers",permalink:"/documenter/docs/best-practices/best-practices-integrating-apps/integrating-apps-trusted-browsers"}},l=[{value:"Testing Scenarios",id:"testing-scenarios",children:[{value:"Adding Your Application as a ZenKey Service",id:"adding-your-application-as-a-zenkey-service",children:[]}]},{value:"Carrier Discovery",id:"carrier-discovery",children:[]},{value:"New User Authorization Flow",id:"new-user-authorization-flow",children:[]}],u={toc:l};function d(e){var t=e.components,r=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"After integrating ZenKey with your service, test whether your app can successfully: "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Discover a user's carrier."),(0,o.kt)("li",{parentName:"ul"},"Request an authorization code."),(0,o.kt)("li",{parentName:"ul"},"Receive an authorization response"),(0,o.kt)("li",{parentName:"ul"},"Return user info."),(0,o.kt)("li",{parentName:"ul"},"Issue a token request."),(0,o.kt)("li",{parentName:"ul"},"Authenticate trusted devices and browsers.\n","[block:callout]",'\n{\n"type": "info",\n"body": "Developers who plan to use the Trust Services API for fraud prevention services should also test event alerts and user trait parameters. For more details, please refer to the end of this section."\n}\n',"[/block]")),(0,o.kt)("p",null,"[block:callout]",'\n{\n"type": "warning",\n"body": "If your client is in Dev Mode and not in Standard Mode, enable Developer Mode in the ZenKey app to test. See instructions for turning on Dev Mode in your app ',(0,o.kt)("a",{parentName:"p",href:"https://developer.myzenkey.com/docs/portal-working-with-developer-mode"},"here"),'."\n}\n',"[/block]"),(0,o.kt)("h2",{id:"testing-scenarios"},"Testing Scenarios"),(0,o.kt)("p",null,"Below are several test scenarios to consider when testing your applications. As a best practice, ZenKey recommends testing each scenario on all platforms relevant to your app (e.g. iOS, Android, web) as well as devices configured to different wireless providers (e.g., AT&T, Verizon, T-Mobile)."),(0,o.kt)("h3",{id:"adding-your-application-as-a-zenkey-service"},"Adding Your Application as a ZenKey Service"),(0,o.kt)("p",null,"[block:callout]",'\n{\n"type": "info",\n"body": "This is only possible once your client is in Standard Mode."\n}\n',"[/block]","\nIn this scenario, new users want to access your service's app on their primary mobile devices prior to authenticating with ZenKey. Mirror this action in the ZenKey app by taking the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Download the carrier's version of the ZenKey app on a device that has not authorized your app."),(0,o.kt)("li",{parentName:"ol"},"Create a new ZenKey account and confirm your identity."),(0,o.kt)("li",{parentName:"ol"},"If your service requires second-factor authentication, set up a biometric recovery method."),(0,o.kt)("li",{parentName:"ol"},'Navigate to Services > tap the "+" icon > search for your service and test that your application appears.'),(0,o.kt)("li",{parentName:"ol"},"Add your application to ZenKey Services > select your application."),(0,o.kt)("li",{parentName:"ol"},"On Account Details, verify that the scopes you wish to request from your users appear as expected.")),(0,o.kt)("h2",{id:"carrier-discovery"},"Carrier Discovery"),(0,o.kt)("p",null,"In this scenario, users added your service to their local ZenKey app. Test to see if your app can properly identify that user's carrier. To do so, follow these steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'Initiate Carrier Discovery\nPreferably on the same device as above, open your service\'s app and select the "Sign in with ZenKey" button. Because this will initiate carrier discovery, test that your REST GET request includes a:')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"BASE_URL: The Base URL you created in the Developer Portal (e.g. ",(0,o.kt)("a",{parentName:"li",href:"https://discoveryissuer.xcijv.com/.well-known/openid_configuration"},"https://discoveryissuer.xcijv.com/.well-known/openid_configuration"),"). "),(0,o.kt)("li",{parentName:"ul"},"CLIENT_ID: The App ID created during registration (e.g. =ccid-{client_ID_value_here})"),(0,o.kt)("li",{parentName:"ul"},"MCCMNC: The six-digit code located on every SIM card identifying the mobile country code, mcc, and mobile operator code, or mnc (e.g. 421249). When calls are made from a mobile device, the MCC and MNC should be provided.")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Verify Carrier and OpenID Configuration\nNext, test that the appropriate carrier was found. If so, test that the proper OpenID Connect configuration was returned. A proper discovery payload should include a token endpoint, user info endpoint, supported scopes, and an authorization URL based on the mobile provider. For example:\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"{\n   \u201cissuer\u201d:\u201chttps://carrier.com\u201d,\n   \u201cauthorization_endpoint\u201d:\u201chttps://carrier.com/connect/authorize\u201d,\n   \u201ctoken_endpoint\u201d:\u201chttps://carrier.com/connect/token\u201d,\n   ...\n   \u201cuserinfo_endpoint\u201d:\u201chttps://carrier.com/connect/userinfo\u201d,\n   \u201cmccmnc\u201d:310010,\n   ...\n   \u201cregistration_endpoint\u201d:\u201dhttps://xcijv.com/connect/register\u201d\n   \u201cscopes_supported\u201d:[\n      \u201cprofile\u201d,\n      \u201cname\u201d,\n      \u201cemail\u201d,\n      \u201cphone\u201d,\n      \u201cpostal_code\u201d\n   ],\n   \u201cresponse_types_supported\u201d:[\n      \u201ccode\u201d,\n      \u201casync_token\u201d\n   ],\n   \u201cgrant_types_supported\u201d:\u201cauthorization_code\u201d,\n   \u201cacr_values_supported\u201d:[\n      \u201ca1\u201d,\n      \u201ca3\u201d\n   ],\n  ...\n}\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Discovery on a Secondary Device\nIf the carrier was not found because you are using a secondary device, test that the user reached the Discovery UI website to identify their carrier. The Discovery UI website should display a \u201cConnect browser to your ZenKey\u201d page to scan a visual code or enter a manual code to add the browser as a trusted device. Recall that this DISCOVERY_UI_URI is the endpoint to your service\u2019s app and should include a:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"BASE_URL: The Base URL you created in the Developer Portal (e.g. ",(0,o.kt)("a",{parentName:"li",href:"https://discoveryissuer.xcijv.com/.well-known/openid_configuration"},"https://discoveryissuer.xcijv.com/.well-known/openid_configuration"),"). "),(0,o.kt)("li",{parentName:"ul"},"CLIENT_ID: The App ID created during registration (e.g. =ccid-{client_ID_value_here})"),(0,o.kt)("li",{parentName:"ul"},"REDIRECT_URI: A URI encoded https (or custom) scheme registered under your Client ID; redirects the user back to your application after discovery is complete.")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"App Redirect\nAfter submitting either the visual or numeric code on the secondary device, test that the browser redirects users back to your app and that the response includes:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"LOGIN_HINT_TOKEN: Only returned from a secondary device. When present, it should be used in your authentication request. When not present, you do not need a login hint in your authentication request.")),(0,o.kt)("h2",{id:"new-user-authorization-flow"},"New User Authorization Flow"),(0,o.kt)("p",null,"In this scenario, users selected \"Sign in with ZenKey\" and your app already discovered users' carriers, per above. Having authenticated your app in ZenKey, users decide whether to share info with you and their carriers. If they do, they'll then experience an app redirect. To test this flow, follow the steps listed here:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Authorization Request\nAfter discovery, test that your application's request to the carrier's authorization endpoint contains:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"CLIENT_ID: The App ID created during registration (e.g. =ccid-{client_ID_value_here})"),(0,o.kt)("li",{parentName:"ul"},"REDIRECT_URI: A URI encoded https (or custom) scheme registered under your Client ID; redirects users back to your application after discovery is complete."),(0,o.kt)("li",{parentName:"ul"},"RESPONSE_TYPE: Standard OpenID code flow."),(0,o.kt)("li",{parentName:"ul"},"NONCE (Optional): String provided by you and included later in the ID token."),(0,o.kt)("li",{parentName:"ul"},"SCOPE: User info attributes specified in your application and defined in the developer portal."),(0,o.kt)("li",{parentName:"ul"},"STATE: Value provided by you; returned with authorization code."),(0,o.kt)("li",{parentName:"ul"},"LOGIN_HINT_TOKEN (Optional): Returned from Discovery UI endpoint as a JWE readable by the carrier. While this parameter is optional, you should include LOGIN_HINT_TOKEN when it is provided by discovery.")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Return Scopes\nOn your test device, check that the scopes your application wishes to request appear as expected. These scopes return by the same carrier user info endpoint revealed during the discovery process. If your scopes were returned properly, test each of the three authorization options presented on the device:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Select "Edit" > Toggle scopes in the local ZenKey app > return to your app.'),(0,o.kt)("li",{parentName:"ul"},'Select "Deny" > Deny Request.'),(0,o.kt)("li",{parentName:"ul"},'Select "Agree" > Provide PIN | Biometric* (if necessary).\n',"[block:callout]",'\n{\n"type": "info",\n"body": "If users do not have biometrics setup in their ZenKey profile, they will not receive a biometric authenticator because biometrics are not recorded in their user info."\n}\n',"[/block]")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Authorization to App Redirect\nProvide consent and test that your app sends an authorization request to the authorization endpoint received during discovery, including the following parameters:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"MCCMNC: The six-digit code located on every SIM card identifying the mobile country code, mcc, and mobile operator code, or mnc (e.g. 421249). When calls are made from a mobile device, the MCC and MNC should be provided."),(0,o.kt)("li",{parentName:"ul"},"CODE: Authorization code."),(0,o.kt)("li",{parentName:"ul"},"CLIENT_ID: Your app ID."),(0,o.kt)("li",{parentName:"ul"},'GRANT_TYPE: Value set to "authorization_code".'),(0,o.kt)("li",{parentName:"ul"},"REDIRECT_URI: A URI encoded https (or custom) scheme registered under your CLIENT_ID.")),(0,o.kt)("p",null,"With the authorization code returned, verify that your app redirects as expected. "),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Token Request\nTest that your app sent a POST request to the carrier token endpoint. The token endpoint expects a ",(0,o.kt)("inlineCode",{parentName:"p"},"CLIENT_SECRET"),", so be sure to test that your API has included this parameter when you issue the request from your secure backend. ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Return User Info\nFinally, test that you received the relevant scopes from the carrier user info endpoint."))))}d.isMDXComponent=!0}}]);